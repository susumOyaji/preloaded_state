<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stock Data Viewer</title>
    <link rel="icon" href="/favicon.png">
    <link rel="stylesheet" href="/style.css">
</head>

<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <h1>Stock Data Viewer</h1>
            <div class="header-actions">
                <button id="refreshBtn" class="icon-btn" title="Refresh">
                    <svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24"
                        fill="currentColor">
                        <path
                            d="M480-160q-134 0-227-93t-93-227q0-134 93-227t227-93q69 0 132 28.5T720-690v-110h80v280H520v-80h168q-32-56-87.5-88T480-720q-100 0-170 70t-70 170q0 100 70 170t170 70q77 0 139-44t87-116h84q-28 106-114 178t-196 72Z" />
                    </svg>
                </button>
                <button id="updateAnalyzeBtn" class="icon-btn" title="Update & Analyze">
                    <svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24"
                        fill="currentColor">
                        <path
                            d="M479-80q-83 0-156-31.5T197-197q-54-54-85.5-127T80-479q0-83 31.5-156T197-761q54-54 127-85.5T479-880q83 0 156 31.5T761-761q54 54 85.5 127T880-479q0 83-31.5 156T761-197q-54 54-127 85.5T479-80Zm0-80q120 0 203-83t83-203q0-120-83-203t-203-83q-120 0-203 83t-83 203q0 120 83 203t203 83Zm1-340q-41 0-70-29t-29-70q0-41 29-70t70-29q41 0 70 29t29 70q0 41-29 70t-70 29ZM440-240v-120H280q-17 0-28.5-11.5T240-379q0-17 11.5-28.5T280-420h120v-120q0-17 11.5-28.5T440-580q17 0 28.5 11.5T480-540v120h120q17 0 28.5 11.5T640-379q0 17-11.5 28.5T600-340H480v120q0 17-11.5 28.5T440-240Z" />
                    </svg>
                </button>
                <button id="settingsBtn" class="icon-btn" title="Settings">
                    <svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24"
                        fill="currentColor">
                        <path
                            d="m370-80-16-128q-13-5-24.5-12T307-235l-119 50L78-375l103-78q-1-7-1-13.5v-27q0-6.5 1-13.5L78-585l110-190 119 50q11-8 23-15t24-12l16-128h220l16 128q13 5 24.5 12t22.5 15l119-50 110 190-103 78q1 7 1 13.5v27q0 6.5-2 13.5l103 78-110 190-118-50q-11 8-23 15t-24 12L590-80H370Zm70-80h79l14-106q31-8 57.5-23.5T639-327l99 41 39-68-86-65q5-14 7-29.5t2-31.5q0-16-2-31.5t-7-29.5l86-65-39-68-99 42q-22-23-48.5-38.5T533-694l-13-106h-79l-14 106q-31 8-57.5 23.5T321-633l-99-41-39 68 86 64q-5 15-7 30t-2 32q0 16 2 31t7 30l-86 65 39 68 99-42q22 23 48.5 38.5T427-266l13 106Zm42-180q58 0 99-41t41-99q0-58-41-99t-99-41q-59 0-99.5 41T342-480q0 58 40.5 99t99.5 41Zm-2-140Z" />
                    </svg>
                </button>
            </div>
        </header>

        <!-- Market Indices -->
        <section class="indices-section">
            <h2 class="section-title">Market Indices</h2>
            <div id="indicesContainer" class="indices-grid">
                <!-- Indices cards will be injected here -->
            </div>
        </section>

        <!-- Dashboard (Portfolio + Signals) -->
        <div class="dashboard-grid">
            <section class="dashboard-segment portfolio-section">
                <h2 class="section-title">Portfolio</h2>
                <div class="portfolio-card">
                    <div style="font-size: 0.875rem; opacity: 0.8;">Total Asset Value</div>
                    <div id="totalAssetValue" class="portfolio-value">¥0</div>
                    <div id="totalGainLoss" class="portfolio-gain text-neutral">
                        <span>¥0 (0.00%)</span>
                    </div>
                    <div id="totalDayChange" style="font-size: 0.75rem; margin-top: 4px; opacity: 0.9;">
                        前日比: ¥0 (0.00%)
                    </div>
                </div>
            </section>

            <section id="signalsSection" class="dashboard-segment signals-section hidden">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                    <h2 class="section-title" style="margin: 0;">Signals</h2>
                    <button id="clearSignalsBtn" class="secondary-btn"
                        style="padding: 4px 12px; font-size: 0.75rem;">Clear All</button>
                </div>
                <div id="signalsContainer" class="signals-container">
                    <!-- Signals will be injected here -->
                </div>
            </section>
        </div>

        <!-- Watchlist Section -->
        <section>
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                <h2 class="section-title" style="margin: 0;">Watchlist</h2>
                <button id="addStockBtn" class="icon-btn" title="Add Stock">
                    <svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24"
                        fill="currentColor">
                        <path d="M440-440H200v-80h240v-240h80v240h240v80H520v240h-80v-240Z" />
                    </svg>
                </button>
            </div>
            <div id="watchlistContainer">
                <!-- Watchlist cards will be injected here -->
            </div>
            <div id="emptyState" class="empty-state hidden"
                style="text-align: center; padding: 40px; color: var(--outline);">
                <p>ウォッチリストに銘柄がありません。</p>
                <p>+ ボタンを押して銘柄を追加してください。</p>
            </div>
        </section>
    </div>

    <!-- Add Stock Modal -->
    <div id="addStockModal" class="modal">
        <div class="modal-content">
            <h3 id="modalTitle" class="modal-title">Add Stock</h3>
            <div class="form-group">
                <label
                    style="display:block; margin-bottom:4px; font-size:0.875rem; color:var(--on-surface-variant);">Code</label>
                <input type="text" id="stockInput" class="input-field" placeholder="e.g. 7203.T" autofocus>
            </div>
            <div class="form-group">
                <label
                    style="display:block; margin-bottom:4px; font-size:0.875rem; color:var(--on-surface-variant);">Broker
                    (Optional)</label>
                <input type="text" id="brokerInput" class="input-field" placeholder="e.g. SBI, Rakuten">
            </div>
            <div class="form-group">
                <label
                    style="display:block; margin-bottom:4px; font-size:0.875rem; color:var(--on-surface-variant);">Quantity</label>
                <input type="number" id="quantityInput" class="input-field" placeholder="0" min="0">
            </div>
            <div class="form-group">
                <label
                    style="display:block; margin-bottom:4px; font-size:0.875rem; color:var(--on-surface-variant);">Average
                    Price</label>
                <input type="number" id="priceInput" class="input-field" placeholder="0" min="0" step="0.01">
            </div>
            <div class="modal-actions">
                <button id="cancelAddBtn" class="secondary-btn">Cancel</button>
                <button id="confirmAddBtn" class="primary-btn">Confirm</button>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settingsModal" class="modal">
        <div class="modal-content">
            <h3 class="modal-title">Settings</h3>
            <div class="form-group">
                <label
                    style="display:block; margin-bottom:4px; font-size:0.875rem; color:var(--on-surface-variant);">API
                    Endpoint</label>
                <input type="text" id="apiEndpoint" class="input-field" placeholder="Leave empty for current origin">
            </div>
            <div class="form-group">
                <label
                    style="display:block; margin-bottom:4px; font-size:0.875rem; color:var(--on-surface-variant);">Refresh
                    Interval (seconds)</label>
                <input type="number" id="refreshInterval" class="input-field" placeholder="30" min="5">
            </div>
            <div class="form-group">
                <label style="display:flex; align-items:center; gap:8px; cursor:pointer;">
                    <input type="checkbox" id="themeToggle">
                    <span style="font-size:0.875rem; color:var(--on-surface-variant);">Dark Mode</span>
                </label>
            </div>
            <div class="modal-actions">
                <button id="cancelSettings" class="secondary-btn">Cancel</button>
                <button id="saveSettings" class="primary-btn">Save</button>
            </div>
        </div>
    </div>

    <!-- Toast -->
    <div id="toast" class="toast"></div>

    <script src="/app.js"></script>
</body>

</html>